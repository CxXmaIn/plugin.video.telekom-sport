sudo: false
language: python

python:
  - "2.7"

script:
  - make all
  - touch ./_build/.nojekyll
  - codeclimate-test-reporter
  - echo $TRAVIS_TAG
  - if [ -z "$TRAVIS_TAG" ]; then
      echo "bar";
    else
      echo "foo"
    fi


deploy:
  - provider: releases
    github_token: $GITHUB_TOKEN
    tag_name: $CURRENT_VERSION
    name: $CURRENT_VERSION
    body: $LAST_CHANGES
    on:
      tags: true
      branch: master
  - provider: pages
    skip_cleanup: true
    github_token: $GITHUB_TOKEN
    local_dir: _build
    target_branch: gh-pages
    on:
      tags: true
      branch: master

notifications:
  email:
    on_success: change
    on_failure: always
